var testsAllData,testsData={};router.route("tests",function(){function e(){function l(){if(navigator.userAgent.toLowerCase().indexOf("msie")!=-1&&!document.createElement("SVG").getAttributeNS){var a=document.querySelectorAll(".tests__item");if(a[0])if(document.body.clientWidth<640)for(var b=0;b<a.length;b++)a[b].style.width="94%";else if(document.body.clientWidth<960)for(b=0;b<a.length;b++)a[b].style.width="45%";else if(document.body.clientWidth<1920)for(b=0;b<a.length;b++)a[b].style.width="";else for(b=0;b<a.length;b++)a[b].style.width="20%"}}var b,d,e,f,a=!1;if(!/^\d+$/.test(c[c.length-1]))return void router.toPath(window.location.hash.slice(1)+"/1");if(a=c.pop(),currentPath.replace(/\d+$/,"")!==previousPath.replace(/\d+$/,"")||currentPath===previousPath){testsData.tests=testsAllData.tests,"sortedAlph"===c[1]?b=c.splice(1,1):"sortedReverseAlph"===c[1]?d=c.splice(1,1):"sortedSmallToBig"===c[1]?e=c.splice(1,1):"sortedBigToSmall"===c[1]&&(f=c.splice(1,1));for(var g=1;g<c.length;g++)testsData.tests=testsData.tests.filter(function(a){return!!~a.name.toLowerCase().indexOf(c[g].toLowerCase())});b?testsData.tests=testsData.tests.slice().sort(function(a,b){return a.name.toLowerCase()>b.name.toLowerCase()?1:-1}):d?testsData.tests=testsData.tests.slice().sort(function(a,b){return a.name.toLowerCase()>b.name.toLowerCase()?-1:1}):e?testsData.tests=testsData.tests.slice().sort(function(a,b){return a.questionsCount-b.questionsCount}):f&&(testsData.tests=testsData.tests.slice().sort(function(a,b){return b.questionsCount-a.questionsCount}))}var h={};if(h.tests=[],h.paginationCount=0,h.currentPage=a,testsData.tests.length>12){var i=Math.ceil(testsData.tests.length/12);if(a<i&&a>0)h.paginationCount=i,h.tests=testsData.tests.slice(12*(a-1),12*a);else{if(!(a==i&&a>0))return void(mainContent.innerHTML=window.Templates.NotFound({}));h.paginationCount=i,h.tests=testsData.tests.slice(12*(a-1))}}else{if(a&&1!=a)return void(mainContent.innerHTML=window.Templates.NotFound({}));h.tests=testsData.tests.slice()}mainContent.innerHTML=window.Templates.Tests(h);var j=document.querySelector(".sort"),k=document.querySelector(".filter");k&&(k.onchange=function(){var a=window.location.hash.replace("basic/","").replace("intermediate/","").replace("hard/","").replace(/\d+$/,"1"),c=7;b?c+="sortedAlph/".length:d?c+="sortedReverseAlph/".length:(e||f)&&(c+="sortedSmallToBig/".length),0==this.selectedIndex?window.location.hash=a:1==this.selectedIndex?window.location.hash=a.slice(0,c)+"basic/"+a.slice(c):2==this.selectedIndex?window.location.hash=a.slice(0,c)+"intermediate/"+a.slice(c):window.location.hash=a.slice(0,c)+"hard/"+a.slice(c)}),j&&(j.onchange=function(){var a=window.location.hash.replace(/sorted\w+\//,"").replace(/\d+$/,"1");0==this.selectedIndex?window.location.hash=a:1==this.selectedIndex?window.location.hash=a.slice(0,7)+"sortedAlph/"+a.slice(7):2==this.selectedIndex?window.location.hash=a.slice(0,7)+"sortedReverseAlph/"+a.slice(7):3==this.selectedIndex?window.location.hash=a.slice(0,7)+"sortedSmallToBig/"+a.slice(7):4==this.selectedIndex&&(window.location.hash=a.slice(0,7)+"sortedBigToSmall/"+a.slice(7))}),l(),window.addEventListener("resize",function(){l()})}function h(a){function o(){for(var a=0,b=[],c=0;c<m.length;c++){var d=m[c].querySelectorAll(".question__input"),n=m[c].querySelectorAll(".question__input[data-correct = '1']"),o=n.length,p=0;m[c].style.display="none";for(var q=0;q<d.length;q++)d[q].checked&&p++;p||b.push(c+1);for(var r=0;r<o;r++)n[r].checked&&(a+=p>o?1/p:1/o)}if(!e&&b.length)var s=confirm("Вы не ответили на вопрос №"+b+". Вернуться к выполнению этих заданий?");if(s)for(i.style.display=h.style.display=g.style.cssFloat="none",c=0;c<b.length;c++)m[b[c]-1].style.display="block";else{clearTimeout(f),document.querySelector(".quiz__timer").style.display="none",a=Math.round(100*a)/100;var t=Math.round(a/m.length*1e4)/100;i.style.display=h.style.display=g.style.display="none",j.style.display=k.style.display="inline-block",l.innerHTML="Ваш результат - "+a+" из "+m.length+" ("+t+"%)",j.onclick=function(){this.style.display="none";for(var a=0;a<m.length;a++){m[a].style.display="block";for(var b=m[a].querySelectorAll(".question__input"),d=(m[a].querySelectorAll(".question__input[data-correct = '1']"),0);d<b.length;d++)b[d].setAttribute("disabled","disabled"),b[d].parentNode.style.color="gray",b[d].checked&&(b[d].parentNode.style.outline="1px solid red",b[d].parentNode.style.color="red"),1==b[d].getAttribute("data-correct")&&(b[d].parentNode.style.color="lime",b[d].checked&&(b[d].parentNode.style.outlineColor="lime"))}}}}mainContent.innerHTML=window.Templates.StartTest(a);var e,b=60*a.time*1e3,c=document.querySelector(".quiz__time"),d=document.querySelector(".quiz__time-switcher"),f=setInterval(function(){var a=Math.floor(b/6e4)+"";1==a.length&&(a=0+a);var f=Math.floor(b/1e3%60)+"";1==f.length&&(f=0+f),c.innerHTML=a+":"+f,6e4==b&&(c.style.visibility="visible",d.checked="checked"),b<=0&&(e=!0,o()),b-=1e3},1e3);window.addEventListener("hashchange",function(){clearTimeout(f)},!1),d.onclick=function(){"visible"===getComputedStyle(c).getPropertyValue("visibility")?c.style.visibility="hidden":c.style.visibility="visible"};var g=document.querySelector(".quiz__button_end"),h=document.querySelector(".quiz__button_back"),i=document.querySelector(".quiz__button_forward"),j=document.querySelector(".quiz__button_show-stats"),k=document.querySelector(".quiz__button_to-tests"),l=document.querySelector(".quiz__result"),m=document.querySelectorAll(".question"),n=0;m[n].style.display="block",i.onclick=function(){n<m.length-1&&(m[n].style.display="",m[++n].style.display="block",n==m.length-1&&(i.style.cursor="default",i.style.opacity="0.2",i.style.filter="alpha(opacity=20)")),1==n&&(h.style.opacity="1",h.style.filter="alpha(opacity=100)",h.style.cursor="pointer")},h.onclick=function(){n>0&&(m[n].style.display="",m[--n].style.display="block",0===n&&(h.style.cursor="default",h.style.opacity="0.2",h.style.filter="alpha(opacity=20)")),n==m.length-2&&(i.style.opacity="1",i.style.filter="alpha(opacity=100)",i.style.cursor="pointer")},g.onclick=o}if(setHeaderLinkColor(1),!document.querySelector("link[href='css/tests.css']")){var a=document.createElement("link");a.rel="stylesheet",a.href="css/tests.css",head.appendChild(a)}var b=!1,c=window.location.hash.slice(1).split("/");if("[-start-]"===c[c.length-1]&&(b=c.pop()),b){var f=new XMLHttpRequest,g="data/"+window.location.hash.slice(7,window.location.hash.length-10).replace(/\//g," ").toLowerCase()+".json";f.open("GET",g,!0),f.send(),f.onreadystatechange=function(){4==f.readyState&&(200!=f.status?mainContent.innerHTML="<div class = 'error'><p>К сожалению, тест еще не готов или недоступен(((</p><p><button class = 'button' onClick='history.back();'>&#8592;Вернуться назад</button></p></div>":h(JSON.parse(f.responseText)))}}else if(testsAllData)e();else{var d=new XMLHttpRequest;d.open("GET","data/testsNames.json",!0),d.send(),d.onreadystatechange=function(){4==d.readyState&&(200!=d.status?mainContent.innerHTML="<div class = 'error'><p>Произошла ошибка! Тесты недоступны (((</p><p>Извините за неудобства</p><p><button class = 'button' onClick='history.back();'>&#8592;Вернуться назад</button></p></div>":(testsAllData=JSON.parse(d.responseText),e()))}}});
